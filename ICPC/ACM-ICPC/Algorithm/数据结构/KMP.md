# KMP匹配
### 给定一个字符串 S，以及一个模式串 P，所有字符串中只包含大小写英文字母以及阿拉伯数字。模式串 P在字符串 S中多次作为子串出现。求出模式串 P在字符串 S中所有出现的位置的起始下标
## 定义
$给定一个长度为 n 的字符串 s，其 前缀函数 被定义为一个长度为 n 的数组 \pi。 其中 \pi[i] 的定义是：$

$如果子串 s[0\dots i] 有一对相等的真前缀与真后缀：s[0\dots k-1] 和 s[i - (k - 1) \dots i]，那么 \pi[i] 就是这个相等的真前缀（或者真后缀，因为它们相等））的长度，也就是 \pi[i]=k；
如果不止有一对相等的，那么 \pi[i] 就是其中最长的那一对的长度；
如果没有相等的，那么 \pi[i]=0。
简单来说 \pi[i] 就是，子串 s[0\dots i] 最长的相等的真前缀与真后缀的长度。$

用数学语言描述如下：


$\pi[i] = \max_{k = 0 \dots i}\{k: s[0 \dots k - 1] = s[i - (k - 1) \dots i]\}
特别地，规定 \pi[0]=0。$

### 过程
#### 举例来说，对于字符串 abcabcd，

$\pi[0]=0，因为 a 没有真前缀和真后缀，根据规定为 0$

$\pi[1]=0，因为 ab 无相等的真前缀和真后缀$

$\pi[2]=0，因为 abc 无相等的真前缀和真后缀$

$\pi[3]=1，因为 abca 只有一对相等的真前缀和真后缀：a，长度为 1$

$\pi[4]=2，因为 abcab 相等的真前缀和真后缀只有 ab，长度为 2$

$\pi[5]=3，因为 abcabc 相等的真前缀和真后缀只有 abc，长度为 3$

$\pi[6]=0，因为 abcabcd 无相等的真前缀和真后缀$

$同理可以计算字符串 aabaaab 的前缀函数为 [0, 1, 0, 1, 2, 2, 3]。$
```
#include<bits/stdc++.h>
using namespace std;

const int N = 100010, M = 1000010;
char p[N], s[M];
int n, m, ne[N];

int main()
{
    cin >> n >> p + 1 >> m >> s + 1;
    
    for(int i = 2, j = 0; i <= n; i ++ )
    {
        while(j && p[i] != p[j + 1]) j = ne[j];
        
        if(p[i] == p[j + 1]) j ++ ;
//前i个字母前后缀最多有j个相同的，后缀的下一个字母j+1与i不匹配.
//则指针后缀直接跳到前缀，看前缀下一个开始与i匹配
        ne[i] = j;
    }

    for(int i = 1, j = 0; i <= m; i ++ )
    {
        while(j && s[i] != p[j + 1]) j = ne[j];
        if(s[i] == p[j + 1]) j ++ ;
        if(j == n)
        {
            cout << i - n << ' ';
            j = ne[j];
        }
    }
    
    return 0;
}
```

- 子串
$字符串 S 的 子串 ，S[i..j]，i≤j，表示 S 串中从 i 到 j 这一段，也就是顺次排列 S[i],S[i+1],\ldots,S[j] 形成的字符串。
有时也会用 S[i..j]，i>j 来表示空串$

- 子序列
$字符串 S 的 子序列 是从 S 中将若干元素提取出来并不改变相对位置形成的序列，即 S[p_1],S[p_2],\ldots,S[p_k]，1\le p_1< p_2<\cdots< p_k\le|S|。$

- 后缀
$后缀 是指从某个位置 i 开始到整个串末尾结束的一个特殊子串。字符串 S 的从 i 开头的后缀表示为 \textit{Suffix(S,i)}，也就是 \textit{Suffix(S,i)}=S[i..|S|-1]。$

- 真后缀
$指除了 S 本身的 S 的后缀。
举例来说，字符串 abcabcd 的所有后缀为 {d, cd, bcd, abcd, cabcd, bcabcd, abcabcd}，而它的真后缀为 {d, cd, bcd, abcd, cabcd, bcabcd}$。

- 前缀
$前缀 是指从串首开始到某个位置 i 结束的一个特殊子串。字符串 S 的以 i 结尾的前缀表示为 Prefix(S,i)，也就是Prefix(S,i)=S[0..i]$

- 真前缀
指除了 S 本身的 S 的前缀。举例来说，字符串 abcabcd 的所有前缀为 {a, ab, abc, abca, abcab, abcabc, abcabcd}, 而它的真前缀为 {a, ab, abc, abca, abcab, abcabc}。

- 字典序
  以第 i 个字符作为第 i 关键字进行大小比较，空字符小于字符集内任何字符（即：a< aa）。

- 回文串
$回文串 是正着写和倒着写相同的字符串，即满足 \forall 1\le i\le|s|, s[i]=s[|s|+1-i] 的 s$

- ### 字符串的存储
使用 char 数组存储，用空字符 \0 表示字符串的结尾（C 风格字符串）。
使用 C++ 标准库提供的 string 类。
字符串常量可以用字符串字面量（用双引号括起来的字符串）表示。

